<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/jquery-3.5.1.min.js"></script>
    <script src="js/lodash-4.17.15.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/dx.common.css"/>
    <link rel="dx-theme" data-theme="generic.light" href="css/dx.light.css"/>
    <link rel="stylesheet" type="text/css" href="css/grid.css"/>
    <script src="js/dx.all.js"></script>
    <script src="dxDataGridUtil.js"></script>
    <script src="gridData.js"></script>

    <style>
        .backGroundColor {
            background-color: #61c6bf;
            font-size: 13px;
        }
    </style>
</head>
<body class="dx-viewport">

<div class="demo-container">
    <div id="headerTest">
        <div id="headerTestContainer"></div>
    </div>
</div>
<p></p>
<button onclick="onGetGridData(gridID)">getGridData</button>
<button onclick="onGetCheckedData(gridID)">onGetCheckedData</button>
<button onclick="onAddRow(gridID, obj)">onAddRow</button>
<button onclick="onAddRow(gridID, {})">onAddEmptyRow</button>
<p></p>
<button onclick="onSetColumnAlignment(gridID)">Alignment</button>
<button onclick="onSetColumnWidth(gridID)">width</button>
<button onclick="onSetColumnDataType(gridID)">DataType</button>
<button onclick="onSetColumnEditing(gridID)">False Editing</button>
<button onclick="onSetGridReadOnlyMode(gridID)">ReadOnly</button>
<p></p>
<button onclick="onSetGridEditMode(gridID)">EditMode</button>
<button onclick="onSetColumnType(gridID, 'Country', 'textarea')">Textarea Type</button>
<button onclick="onSetColumnType(gridID, 'Area', 'button')">Button Type</button>
<button onclick="onSetColumnType(gridID, 'Population_Total', 'comboBox', countries, 'ID', 'Country', true)">ComboBox Type</button>
<button onclick="onSetColumnType(gridID, 'GDP_Total', 'date')">Date Type</button>
<button onclick="onSetColumnType(gridID, 'GDP_Agriculture', 'checkBox')">CheckBox Type</button>
<button onclick="onSetColumnType(gridID, 'GDP_Services', 'mask')">Mask Type</button>
<button onclick="onSetColumnType(gridID, 'Picture', 'image')">Image Type</button>
<p></p>
<div class="demo-container">
    <div id="headerTest2">
        <div id="headerTestContainer2"></div>
    </div>
</div>
<p></p>
<button onclick="onSetGridEditMode(gridID2)">EditMode</button>
<button onclick="onSetColumnType(gridID2, 'Name', 'comboBox', ComboData, 'Name', 'Name', false)">Name ComboBox Type</button>
<button onclick="onSetColumnType(gridID2, 'Test2', 'comboBox', ComboData, 'Name', 'Name', false)">Area ComboBox Type</button>
<button onclick="onSetComboBoxLookUp(gridID2, 'Name', 'Test2')">Name Change Selection Event</button>


<script>

    var gridID = "#headerTestContainer";
    var gridID2 = "#headerTestContainer2";
    var obj = {
        "ID": 11,
        "Country": "United",
        "Area": 244820,
        "Population_Urban": 0.82,
        "Population_Rural": 0.18,
        "Population_Total": 65097000,
        "GDP_Agriculture": 0.007,
        "GDP_Industry": 0.21,
        "GDP_Services": 0.783,
        "GDP_Total": 2945146,
        "Picture": "css/images/cat01.jpg"
    }

    $(function () {

        // header :: caption, dataField, columns(하위그룹)으로 이루어진다.
        // column :: dataField를 PK로 header와 연결된다.
        let gridId = gridID;
        let header  = new Array();
        let column = new Array();
        header = [
            {
                "caption":"Country", "dataField": "Country",
            },
            {
                "caption":"Area, km<sup>2</sup>", "dataField": "Area",
            },
            {
                "caption":"Population", "dataField": "",
                "columns": [
                    {"caption":"Total", "dataField": "Population_Total"},
                    {"caption":"Urban", "dataField": "Population_Urban"},
                ]
            },
            {
                "caption":"Nominal\nGDP", "dataField": "",
                "columns": [
                    {"caption":"Total, mln $", "dataField": "GDP_Total"},
                    {"caption":"By Sector", "dataField": "",
                        "columns": [
                            {"caption":"Agriculture", "dataField": "GDP_Agriculture"},
                            {"caption":"Industry", "dataField": "GDP_Industry"},
                            {"caption":"Services", "dataField": "GDP_Services"},
                        ]
                    },
                ]
            },
            {
                "caption": "Picture", "dataField": "Picture"
            }
        ];

        column = [
            new Column.config.set("Country","30%","center","10",{"cssClass":"backGroundColor"}),
            new Column.config.set("Population_Total","100px","center",""),
            new Column.config.set("GDP_Agriculture","95","right","",{"format": {"type": "percent","precision": "1"}},"sum"),
            new Column.config.set("GDP_Industry","80","left","",{"format": {"type": "percent","precision": "1"}}),
            new Column.config.set("GDP_Services","85","center","",{"format": {"type": "percent","precision": "1"}}),
        ]
        console.log("obj",new Column.config.set("Country","30%","center",{"cssClass":"backGroundColor"}));


        Grid.config.setGridColumns(gridId, header, column);
        Grid.config.setGridData(gridId, countries);
        onSetGridEditMode(gridId);
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////

        let gridId2 = gridID2;
        let header2  = new Array();
        let column2 = new Array();
        header2 = [
            {
                "caption":"Test1", "dataField":"Name"
            },
            {
                "caption":"Test2", "dataField":"Test2"
            }
        ];

        Grid.config.setGridColumns(gridId2, header2, column2);
        Grid.config.setGridData(gridId2, ComboData);

    });

    function onSetColumnAlignment(gridId) {
        Column.config.setOneColumnOptionalFields(gridId, "alignment")("Country","right");
    }
    function onSetColumnWidth(gridId) {
        Column.config.setOneColumnOptionalFields(gridId, "width")("GDP_Agriculture","20%");
    }
    function onSetColumnDataType(gridId) {
        Column.config.setOneColumnOptionalFields(gridId, "dataType")("GDP_Industry","date");
    }
    function onSetColumnEditing(gridId) {
        Column.config.setOneColumnOptionalFields(gridId, "allowEditing")("GDP_Services",false);
    }
    function onGetGridData(gridId) {
        Grid.method.getGridData(gridId);
    }
    function onGetCheckedData(gridId) {
        Grid.method.getCheckedData(gridId);
    }
    function onAddRow(gridId, obj) {
        Grid.method.addRow(gridId, obj);
    }

    function onSetColumnType(gridId, dataField, type, ...args) {
        let editType = Column.config.setColumnType(gridId, type);
        if (type === "comboBox") {
            editType(dataField, args[0], args[1], args[2], args[3]);
        } else {
            editType(dataField);
        }
        // console.log("instance", $(gridId).dxDataGrid("instance").option('columns'));
    }


    function onSetGridEditMode(gridId) {
        Grid.config.setEditMode(gridId, true, true, true, "multiple");
    }
    function onSetGridReadOnlyMode(gridId) {
        Grid.config.setEditMode(gridId, false, false, false, "none");
    }

    function onSetComboBoxLookUp(gridId, dataField, dependentField) {
        Column.method.setComboBoxLookUp(gridId, dataField, dependentField);
        // let instance = $(gridId).dxDataGrid("instance");
        // instance.columnOption(dependentField, "lookup.dataSource", countries);
        // instance.columnOption(dependentField, "lookup.valueExpr", 'ID');
        // instance.columnOption(dependentField, "lookup.displayExpr", 'Country');
        // instance.columnOption(dependentField, "lookup.allowClearing", false);
    }








</script>

</body>
</html>