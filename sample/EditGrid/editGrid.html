<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Edit Grid</title>
<script src="js/jquery-3.5.1.min.js"></script>
<script src="js/lodash-4.17.15.min.js"></script>
<link rel="stylesheet" type="text/css" href="css/dx.common.css"/>
<link rel="stylesheet" type="text/css" href="css/grid_back.css"/>
<link rel="stylesheet" type="text/css" href="css/grid-custom-2.css"/>
<script src="js/dx.custom.js"></script>
<!--<script src="js/dx.all.debug.js"></script>-->
<script src="editGrid.js"></script>
</head>
<body>

<body class="dx-viewport">

<div class="demo-container" style="display: flex">
	<div id="headerTest">
		<div id="headerTestContainer"></div>
	</div>
	<div id="headerTest2">
		<div id="headerTestContainer2"></div>
	</div>
</div>

<p>결과 값은 콘솔창</p>
<button onclick="onGetGridData(gridId1)">모든 데이터 가져오기 1 </button>
<button onclick="onGetGridData(gridId2)">모든 데이터 가져오기 2</button>
<button onclick="onGetCheckedData(gridId1)">선택한 데이터 가져오기</button>
<button onclick="onAddRow(gridId1, {})">빈 행 추가</button>
<button onclick="onAddRow(gridId1, obj)">파라미터있는 새로운 행 추가</button>
<button onclick="onDeleteRow(gridId1)">선택한 행 일괄삭제</button>
<button onclick="onSaveEditData(gridId1)">편집저장</button>
<button onclick="onSetData(gridId1)">데이터 조회하기 grid1</button>
<button onclick="onSetData(gridId2)">데이터 조회하기 grid2</button>
<p>TEST METHOD</p>


<script>
// Logger.setLogLevel(LOG_LEVEL_WARN);
const gridId1 = "#headerTestContainer";
const gridId2 = "#headerTestContainer2";

// gridId1의 focused Row 를 gridId2에 display
Listener.grid.onFocusedRowChanged = function (gridId, component, element, model, row, rowElement, rowIndex) {
	if (gridId == gridId1) {
		// let keyArr = ["Country", "Area"];
		// Grid.method.setGridFilter(gridId2, keyArr, row.data);
	}
}

const obj = {
	"ID": 11,
	"Country": "United",
	"Area": 244820,
	"Population_Urban": 0.82,
	"Population_Rural": 0.18,
	"Population_Total": 65097000,
	"GDP_Agriculture": 0.007,
	"GDP_Industry": 0.21,
	"GDP_Services": 0.783,
	"GDP_Total": 2945146,
	"Picture": "css/images/cat01.jpg"
};

$(document).ready(function () {
	let band = new Array();
	let columns = new Array();
	let headerCss = new Array();
	let footer = new Array();

	band = [
		new Band("Country"),
		new Band("Area"),
		new Band("국가총생산", [
			new Band("Population_Total"),
			new Band("Population_Urban"),
		]),
		new Band("일반\nGDP", [
			new Band("GDP_Total"),
			new Band("분야", [
				new Band("GDP_Agriculture"),
				new Band("GDP_Industry"),
				new Band("GDP_Services"),
			]),
		]),
	]

	columns = [
		new ColConfig("나라", "Country", 100, "text"),
		new ColConfig("지역", "Area", "auto", "number"),
		new ColConfig("인구 합", "Population_Total", 80, "number"),
		new ColConfig("인구(외곽)", "Population_Urban", 80, "percent"),
		new ColConfig("GDP 총합", "GDP_Total", 80, "number", 1),
		new ColConfig("농업", "GDP_Agriculture", 80, "percent", 1),
		new ColConfig("산업", "GDP_Industry", 80, "percent", 1),
		new ColConfig("서비스업", "GDP_Services", 80, "percent", 1),
	];

	Grid.config.setGrid(gridId1, "", "", true);
	Column.config.setColumn(gridId1, columns);
	// Grid.method.setGridDataByObj(gridId1, countries);
	// Header.config.setHeader(gridId1, columns, band);
	// Grid.method.setGridData(gridId1, countries);

	// Header CSS
	headerCss = [
		new Attribute("background-color", "#f5f5f5"),
		new Attribute("vertical-align", "middle"),
		new Attribute("text-align", "center"),
	]
	Header.config.setCss(gridId1, headerCss);

	Grid.config.setEditMode(gridId1, true);
	// Grid.config.setSorting(gridId1, "none");

	// Footer
	footer = [
		new Footer("Country", "text", "합계"),
		new Footer("Population_Total", "sum"),
		new Footer("Population_Urban", "avg", "평균: ", ""),
		new Footer("GDP_Agriculture", "min", "", Column.dataFormat("percent", 2), "center"),
		new Footer("GDP_Industry", "max"),
	]
	Grid.config.setFooter(gridId1, footer);

});

$(document).ready(function () {
	let columns2 = [
		new ColConfig("나라", "Country", "100%", "text"),
		new ColConfig("지역", "Area", "100%", "number"),
		new ColConfig("인구 합", "Population_Total", "100%", "number"),
		new ColConfig("인구(외곽)", "Population_Urban", "100%", "percent"),
		new ColConfig("GDP 총합", "GDP_Total", "100%", "number", 1),
		new ColConfig("농업", "GDP_Agriculture", "100%", "percent", 1),
		new ColConfig("산업", "GDP_Industry", "100%", "percent", 1),
		new ColConfig("서비스업", "GDP_Services", "100%", "percent", 1),
	];

	// Grid.config.setGrid(gridId2, "", 500, false);
	// Column.config.setColumn(gridId2, columns2);
	// Grid.method.setGridData(gridId2, []);

	// Header.config.setCss(gridId2, headerCss);

});


function onGetGridData(gridId) {
	console.log("모든 그리드 데이터", Grid.method.getGridData(gridId));
}

function onGetCheckedData(gridId) {
	console.log("선택한 데이터들", Grid.method.getCheckedData(gridId));
}

function onAddRow(gridId, obj) {
	obj = JSON.parse(JSON.stringify(obj));
	Grid.method.addRow(gridId, obj);
}

function onDeleteRow(gridId) {
	Grid.method.deleteRow(gridId);
}

function onSaveEditData(gridId) {
	Grid.method.saveEditData(gridId);
}

function onSetData(gridId) {
	Grid.method.setGridData(gridId, "gridData.json");
}


</script>

</body>
</html>